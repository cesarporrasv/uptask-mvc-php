!function(){!async function(){try{const a="/api/tasks?id="+s(),n=await fetch(a),o=await n.json();t=o.tasks,e()}catch(t){console.log(t)}}();let t=[];function e(){if(function(){const t=document.querySelector("#tasks-list");for(;t.firstChild;)t.removeChild(t.firstChild)}(),0===t.length){const t=document.querySelector("#tasks-list"),e=document.createElement("LI");return e.textContent="No Hay Tareas",e.classList.add("no-tasks"),void t.appendChild(e)}const o={0:"Pendiente",1:"Completa"};t.forEach(c=>{const d=document.createElement("LI");d.dataset.taskId=c.id,d.classList.add("task");const i=document.createElement("P");i.textContent=c.name,i.ondblclick=function(){a(edit=!0,{...c})};const r=document.createElement("DIV");r.classList.add("options");const l=document.createElement("BUTTON");l.classList.add("task-status"),l.classList.add(""+o[c.status].toLowerCase()),l.textContent=o[c.status],l.dataset.taskStatus=c.status,l.ondblclick=function(){!function(t){const e="1"===t.status?"0":"1";t.status=e,n(t)}({...c})};const u=document.createElement("BUTTON");u.classList.add("delete-task"),u.dataset.idTask=c.id,u.textContent="Eliminar",u.ondblclick=function(){!function(a){Swal.fire({title:"Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&async function(a){const{status:n,id:o,name:c}=a,d=new FormData;d.append("id",o),d.append("name",c),d.append("status",n),d.append("projectId",s());try{const n="http://localhost:3000/api/task/delete",s=await fetch(n,{method:"POST",body:d}),o=await s.json();o.output&&(Swal.fire("Eliminada!",o.message,"success"),t=t.filter(t=>t.id!==a.id),e())}catch(t){}}(a)})}({...c})},r.appendChild(l),r.appendChild(u),d.appendChild(i),d.appendChild(r);document.querySelector("#tasks-list").appendChild(d)})}function a(a=!1,o={}){const c=document.createElement("DIV");c.classList.add("modal"),c.innerHTML=`\n      <form class="form new-task">\n        <legend>${a?"Editar nombre tarea":"Añade un nueva tarea"}</legend>\n        <div class="field">\n          <label>Tarea</label>\n          <input\n            type="text"\n            name="task"\n            placeholder="${o.name?"Edita el nombre":"Añade una tarea al Proyecto"}"\n            id="task"\n            value="${o.name?o.name:""}"\n          />\n        </div>\n        <div class="options">\n          <input \n            type="submit" \n            class="submit-new-task" \n            value="${o.name?"Guardar Cambios":"Añadir Tarea"}" \n          />\n          <button type="button" class="close-modal">Cancelar</button>\n        </div>\n      </form>\n    `,setTimeout(()=>{document.querySelector(".form").classList.add("animate")},150),c.addEventListener("click",(function(d){if(d.preventDefault(),d.target.classList.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{c.remove()},400)}if(d.target.classList.contains("submit-new-task")){const c=document.querySelector("#task").value.trim();if(""===c)return void function(t,e,a){const n=document.querySelector(".alert");n&&n.remove();const s=document.createElement("DIV");s.classList.add("alert",e),s.textContent=t,a.parentElement.insertBefore(s,a.nextElementSibling),setTimeout(()=>{s.remove()},2500)}("Debes agregar un nombre a la tarea","error",document.querySelector(".form legend"));a?(o.name=c,n(o)):async function(a){const n=new FormData;n.append("name",a),n.append("projectId",s());try{const s="http://localhost:3000/api/task",o=await fetch(s,{method:"POST",body:n}),c=await o.json();if(Swal.fire("Agregada!",c.message,"success"),"success"===c.type){const n=document.querySelector(".modal");setTimeout(()=>{n.remove()},2e3);const s={id:String(c.id),name:a,status:"0",projectId:c.projectId};t=[...t,s],e()}}catch(t){console.log(t)}}(c)}})),document.querySelector(".dashboard").appendChild(c)}async function n(a){const{status:n,id:o,name:c,projectId:d}=a,i=new FormData;i.append("id",o),i.append("name",c),i.append("status",n),i.append("projectId",s());try{const a="http://localhost:3000/api/task/update",s=await fetch(a,{method:"POST",body:i}),d=await s.json();if("success"===d.response.type){Swal.fire("Actualizada!",d.response.message,"success");const a=document.querySelector(".modal");a&&a.remove(),t=t.map(t=>(t.id===o&&(t.status=n,t.name=c),t)),e()}}catch(t){console.log(t)}}function s(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}document.querySelector("#add-task").addEventListener("click",(function(){a()}))}();