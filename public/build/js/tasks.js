!function(){!async function(){try{const n="/api/tasks?id="+a(),s=await fetch(n),o=await s.json();t=o.tasks,e()}catch(t){console.log(t)}}();let t=[];function e(){if(function(){const t=document.querySelector("#tasks-list");for(;t.firstChild;)t.removeChild(t.firstChild)}(),0===t.length){const t=document.querySelector("#tasks-list"),e=document.createElement("LI");return e.textContent="No Hay Tareas",e.classList.add("no-tasks"),void t.appendChild(e)}const s={0:"Pendiente",1:"Completa"};t.forEach(o=>{const c=document.createElement("LI");c.dataset.taskId=o.id,c.classList.add("task");const d=document.createElement("P");d.textContent=o.name;const i=document.createElement("DIV");i.classList.add("options");const r=document.createElement("BUTTON");r.classList.add("task-status"),r.classList.add(""+s[o.status].toLowerCase()),r.textContent=s[o.status],r.dataset.taskStatus=o.status,r.ondblclick=function(){!function(s){const o="1"===s.status?"0":"1";s.status=o,async function(s){const{status:o,id:c,name:d,projectId:i}=s,r=new FormData;r.append("id",c),r.append("name",d),r.append("status",o),r.append("projectId",a());try{const a="http://localhost:3000/api/task/update",s=await fetch(a,{method:"POST",body:r}),d=await s.json();"success"===d.response.type&&(n(d.response.message,d.response.type,document.querySelector(".container-new-task")),t=t.map(t=>(t.id===c&&(t.status=o),t)),e())}catch(t){console.log(t)}}(s)}({...o})};const l=document.createElement("BUTTON");l.classList.add("delete-task"),l.dataset.idTask=o.id,l.textContent="Eliminar",l.ondblclick=function(){!function(n){Swal.fire({title:"Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&async function(n){const{status:s,id:o,name:c}=n,d=new FormData;d.append("id",o),d.append("name",c),d.append("status",s),d.append("projectId",a());try{const a="http://localhost:3000/api/task/delete",s=await fetch(a,{method:"POST",body:d}),o=await s.json();o.output&&(Swal.fire("Eliminado!",o.message,"success"),t=t.filter(t=>t.id!==n.id),e())}catch(t){}}(n)})}({...o})},i.appendChild(r),i.appendChild(l),c.appendChild(d),c.appendChild(i);document.querySelector("#tasks-list").appendChild(c)})}function n(t,e,n){const a=document.querySelector(".alert");a&&a.remove();const s=document.createElement("DIV");s.classList.add("alert",e),s.textContent=t,n.parentElement.insertBefore(s,n.nextElementSibling),setTimeout(()=>{s.remove()},2500)}function a(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}document.querySelector("#add-task").addEventListener("click",(function(){const s=document.createElement("DIV");s.classList.add("modal"),s.innerHTML='\n      <form class="form new-task">\n        <legend>Añade una nueva Tarea</legend>\n        <div class="field">\n          <label>Tarea</label>\n          <input\n            type="text"\n            name="task"\n            placeholder="Añade una tarea al Proyecto"\n            id="task"\n          />\n        </div>\n        <div class="options">\n          <input type="submit" class="submit-new-task" value="Añadir Tarea" />\n          <button type="button" class="close-modal">Cancelar</button>\n        </div>\n      </form>\n    ',setTimeout(()=>{document.querySelector(".form").classList.add("animate")},150),s.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{s.remove()},400)}o.target.classList.contains("submit-new-task")&&function(){const s=document.querySelector("#task").value.trim();if(""===s)return void n("Debes agregar un nombre a la tarea","error",document.querySelector(".form legend"));!async function(n){const s=new FormData;s.append("name",n),s.append("projectId",a());try{const a="http://localhost:3000/api/task",o=await fetch(a,{method:"POST",body:s}),c=await o.json();if(console.log(c),Swal.fire("Tarea Agregada Correctamente"),"success"===c.type){const a=document.querySelector(".modal");setTimeout(()=>{a.remove()},2e3);const s={id:String(c.id),name:n,status:"0",projectId:c.projectId};t=[...t,s],e()}}catch(t){console.log(t)}}(s)}()})),document.querySelector(".dashboard").appendChild(s)}))}();