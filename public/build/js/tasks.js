!function(){!async function(){try{const e="/api/tasks?id="+c(),n=await fetch(e),s=await n.json();t=s.tasks,a()}catch(t){console.log(t)}}();let t=[],e=[];document.querySelector("#add-task").addEventListener("click",(function(){s()}));function n(n){const s=n.target.value;e=""!==s?t.filter(t=>t.status===s):[],a()}function a(){!function(){const t=document.querySelector("#tasks-list");for(;t.firstChild;)t.removeChild(t.firstChild)}(),function(){const e=t.filter(t=>"0"===t.status),n=document.querySelector("#to-do");0===e.length?n.disabled=!0:n.disabled=!1}(),function(){const e=t.filter(t=>"1"===t.status),n=document.querySelector("#done");0===e.length?n.disabled=!0:n.disabled=!1}();const n=e.length?e:t;if(0===n.length){const t=document.querySelector("#tasks-list"),e=document.createElement("LI");return e.textContent="No Hay Tareas",e.classList.add("no-tasks"),void t.appendChild(e)}const d={0:"Pendiente",1:"Completa"};n.forEach(e=>{const n=document.createElement("LI");n.dataset.taskId=e.id,n.classList.add("task");const i=document.createElement("P");i.textContent=e.name,i.ondblclick=function(){s(edit=!0,{...e})};const r=document.createElement("DIV");r.classList.add("options");const l=document.createElement("BUTTON");l.classList.add("task-status"),l.classList.add(""+d[e.status].toLowerCase()),l.textContent=d[e.status],l.dataset.taskStatus=e.status,l.ondblclick=function(){!function(t){const e="1"===t.status?"0":"1";t.status=e,o(t)}({...e})};const u=document.createElement("BUTTON");u.classList.add("delete-task"),u.dataset.idTask=e.id,u.textContent="Eliminar",u.ondblclick=function(){!function(e){Swal.fire({title:"Eliminar Tarea?",showCancelButton:!0,confirmButtonText:"Confirmar",cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed&&async function(e){const{status:n,id:s,name:o}=e,d=new FormData;d.append("id",s),d.append("name",o),d.append("status",n),d.append("projectId",c());try{const n="http://localhost:3000/api/task/delete",s=await fetch(n,{method:"POST",body:d}),o=await s.json();o.output&&(Swal.fire("Eliminada!",o.message,"success"),t=t.filter(t=>t.id!==e.id),a())}catch(t){}}(e)})}({...e})},r.appendChild(l),r.appendChild(u),n.appendChild(i),n.appendChild(r);document.querySelector("#tasks-list").appendChild(n)})}function s(e=!1,n={}){const s=document.createElement("DIV");s.classList.add("modal"),s.innerHTML=`\n      <form class="form new-task">\n        <legend>${e?"Editar nombre tarea":"Añade un nueva tarea"}</legend>\n        <div class="field">\n          <label>Tarea</label>\n          <input\n            type="text"\n            name="task"\n            placeholder="${n.name?"Edita el nombre":"Añade una tarea al Proyecto"}"\n            id="task"\n            value="${n.name?n.name:""}"\n          />\n        </div>\n        <div class="options">\n          <input \n            type="submit" \n            class="submit-new-task" \n            value="${n.name?"Guardar Cambios":"Añadir Tarea"}" \n          />\n          <button type="button" class="close-modal">Cancelar</button>\n        </div>\n      </form>\n    `,setTimeout(()=>{document.querySelector(".form").classList.add("animate")},150),s.addEventListener("click",(function(d){if(d.preventDefault(),d.target.classList.contains("close-modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{s.remove()},400)}if(d.target.classList.contains("submit-new-task")){const s=document.querySelector("#task").value.trim();if(""===s)return void function(t,e,n){const a=document.querySelector(".alert");a&&a.remove();const s=document.createElement("DIV");s.classList.add("alert",e),s.textContent=t,n.parentElement.insertBefore(s,n.nextElementSibling),setTimeout(()=>{s.remove()},2500)}("Debes agregar un nombre a la tarea","error",document.querySelector(".form legend"));e?(n.name=s,o(n)):async function(e){const n=new FormData;n.append("name",e),n.append("projectId",c());try{const s="http://localhost:3000/api/task",o=await fetch(s,{method:"POST",body:n}),c=await o.json();if(Swal.fire("Agregada!",c.message,"success"),"success"===c.type){const n=document.querySelector(".modal");setTimeout(()=>{n.remove()},2e3);const s={id:String(c.id),name:e,status:"0",projectId:c.projectId};t=[...t,s],a()}}catch(t){console.log(t)}}(s)}})),document.querySelector(".dashboard").appendChild(s)}async function o(e){const{status:n,id:s,name:o,projectId:d}=e,i=new FormData;i.append("id",s),i.append("name",o),i.append("status",n),i.append("projectId",c());try{const e="http://localhost:3000/api/task/update",c=await fetch(e,{method:"POST",body:i}),d=await c.json();if("success"===d.response.type){Swal.fire("Actualizada!",d.response.message,"success");const e=document.querySelector(".modal");e&&e.remove(),t=t.map(t=>(t.id===s&&(t.status=n,t.name=o),t)),a()}}catch(t){console.log(t)}}function c(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}document.querySelectorAll('#filters, input[type="radio"]').forEach(t=>{t.addEventListener("input",n)})}();